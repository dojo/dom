(function (factory) {
    if (typeof module === 'object' && typeof module.exports === 'object') {
        var v = factory(require, exports); if (v !== undefined) module.exports = v;
    }
    else if (typeof define === 'function' && define.amd) {
        define(["require", "exports", './lang'], factory);
    }
})(function (require, exports) {
    var lang_1 = require('./lang');
    function emit(target, event) {
        if (target.dispatchEvent && target.ownerDocument && target.ownerDocument.createEvent) {
            var nativeEvent = target.ownerDocument.createEvent('HTMLEvents');
            nativeEvent.initEvent(event.type, Boolean(event.bubbles), Boolean(event.cancelable));
            for (var key in event) {
                if (!(key in nativeEvent)) {
                    nativeEvent[key] = event[key];
                }
            }
            return target.dispatchEvent(nativeEvent);
        }
        if (target.emit) {
            if (target.removeListener) {
                target.emit(event.type, event);
                return false;
            }
            else if (target.on) {
                target.emit(event);
                return false;
            }
        }
        throw new Error('Target must be an event emitter');
    }
    exports.emit = emit;
    function on(target, type, listener, capture) {
        if (Array.isArray(type)) {
            var handles = type.map(function (type) {
                return on(target, type, listener, capture);
            });
            return lang_1.createCompositeHandle.apply(void 0, handles);
        }
        var callback = function () {
            listener.apply(this, arguments);
        };
        // DOM EventTarget
        if (target.addEventListener && target.removeEventListener) {
            target.addEventListener(type, callback, capture);
            return lang_1.createHandle(function () {
                target.removeEventListener(type, callback, capture);
            });
        }
        if (target.on) {
            // EventEmitter
            if (target.removeListener) {
                target.on(type, callback);
                return lang_1.createHandle(function () {
                    target.removeListener(type, callback);
                });
            }
            else if (target.emit) {
                return target.on(type, listener);
            }
        }
        throw new TypeError('Unknown event emitter object');
    }
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.default = on;
    function once(target, type, listener, capture) {
        var handle = on(target, type, function () {
            handle.destroy();
            return listener.apply(this, arguments);
        }, capture);
        return handle;
    }
    exports.once = once;
    function pausable(target, type, listener, capture) {
        var paused;
        var handle = on(target, type, function () {
            if (!paused) {
                return listener.apply(this, arguments);
            }
        }, capture);
        handle.pause = function () {
            paused = true;
        };
        handle.resume = function () {
            paused = false;
        };
        return handle;
    }
    exports.pausable = pausable;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvb24udHMiXSwibmFtZXMiOlsiZW1pdCIsIm9uIiwib25jZSIsInBhdXNhYmxlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztJQUNBLHFCQUFvRCxRQUFRLENBQUMsQ0FBQTtJQXdCN0QsY0FBNEMsTUFBVyxFQUFFLEtBQXNCO1FBQzlFQSxFQUFFQSxDQUFDQSxDQUFDQSxNQUFNQSxDQUFDQSxhQUFhQSxJQUFJQSxNQUFNQSxDQUFDQSxhQUFhQSxJQUFJQSxNQUFNQSxDQUFDQSxhQUFhQSxDQUFDQSxXQUFXQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN0RkEsSUFBTUEsV0FBV0EsR0FBR0EsTUFBTUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0E7WUFDbkVBLFdBQVdBLENBQUNBLFNBQVNBLENBQ3BCQSxLQUFLQSxDQUFDQSxJQUFJQSxFQUNWQSxPQUFPQSxDQUFtQkEsS0FBTUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsRUFDekNBLE9BQU9BLENBQW1CQSxLQUFNQSxDQUFDQSxVQUFVQSxDQUFDQSxDQUM1Q0EsQ0FBQ0E7WUFFRkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsSUFBSUEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3ZCQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxXQUFXQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDM0JBLFdBQVdBLENBQUNBLEdBQUdBLENBQUNBLEdBQVVBLEtBQU1BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO2dCQUN2Q0EsQ0FBQ0E7WUFDRkEsQ0FBQ0E7WUFFREEsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsQ0FBQ0E7UUFDMUNBLENBQUNBO1FBRURBLEVBQUVBLENBQUNBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENB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QUUsUUFBYSxFQUFFLE9BQWlCO1FBQzVFQyxJQUFNQSxNQUFNQSxHQUFHQSxFQUFFQSxDQUFDQSxNQUFNQSxFQUFFQSxJQUFJQSxFQUFFQTtZQUMvQixNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDakIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQ3hDLENBQUMsRUFBRUEsT0FBT0EsQ0FBQ0EsQ0FBQ0E7UUFFWkEsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0E7SUFDZkEsQ0FBQ0E7SUFQZSxZQUFJLE9BT25CLENBQUE7SUFpQkQsa0JBQXlCLE1BQVcsRUFBRSxJQUFTLEVBQUUsUUFBYSxFQUFFLE9BQWlCO1FBQ2hGQyxJQUFJQSxNQUFlQSxDQUFDQTtRQUVwQkEsSUFBTUEsTUFBTUEsR0FBb0JBLEVBQUVBLENBQUNBLE1BQU1BLEVBQUVBLElBQUlBLEVBQUVBO1lBQ2hELEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztnQkFDYixNQUFNLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFDeEMsQ0FBQztRQUNGLENBQUMsRUFBRUEsT0FBT0EsQ0FBQ0EsQ0FBQ0E7UUFFWkEsTUFBTUEsQ0FBQ0EsS0FBS0EsR0FBR0E7WUFDZCxNQUFNLEdBQUcsSUFBSSxDQUFDO1FBQ2YsQ0FBQyxDQUFDQTtRQUVGQSxNQUFNQSxDQUFDQSxNQUFNQSxHQUFHQTtZQUNmLE1BQU0sR0FBRyxLQUFLLENBQUM7UUFDaEIsQ0FBQyxDQUFDQTtRQUVGQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQTtJQUNmQSxDQUFDQTtJQWxCZSxnQkFBUSxXQWtCdkIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEhhbmRsZSwgRXZlbnRPYmplY3QgfSBmcm9tICcuL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgY3JlYXRlSGFuZGxlLCBjcmVhdGVDb21wb3NpdGVIYW5kbGUgfSBmcm9tICcuL2xhbmcnO1xuaW1wb3J0IEV2ZW50ZWQgZnJvbSAnLi9FdmVudGVkJztcblxuZXhwb3J0IGludGVyZmFjZSBFdmVudENhbGxiYWNrIHtcblx0KGV2ZW50OiBFdmVudE9iamVjdCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXZlbnRFbWl0dGVyIHtcblx0b24oZXZlbnQ6IHN0cmluZywgbGlzdGVuZXI6IEV2ZW50Q2FsbGJhY2spOiBFdmVudEVtaXR0ZXI7XG5cdHJlbW92ZUxpc3RlbmVyKGV2ZW50OiBzdHJpbmcsIGxpc3RlbmVyOiBFdmVudENhbGxiYWNrKTogRXZlbnRFbWl0dGVyO1xufVxuXG5pbnRlcmZhY2UgRE9NRXZlbnRPYmplY3QgZXh0ZW5kcyBFdmVudE9iamVjdCB7XG5cdGJ1YmJsZXM6IGJvb2xlYW47XG5cdGNhbmNlbGFibGU6IGJvb2xlYW47XG59XG5cbi8qKlxuICogUHJvdmlkZXMgYSBub3JtYWxpemVkIG1lY2hhbmlzbSBmb3IgZGlzcGF0Y2hpbmcgZXZlbnRzIGZvciBldmVudCBlbWl0dGVycywgRXZlbnRlZCBvYmplY3RzLCBvciBET00gbm9kZXMuXG4gKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgdG8gZW1pdCB0aGUgZXZlbnQgZnJvbVxuICogQHBhcmFtIGV2ZW50IFRoZSBldmVudCBvYmplY3QgdG8gZW1pdFxuICogQHJldHVybiBCb29sZWFuIGluZGljYXRpbmcgV2hldGhlciB0aGUgZXZlbnQgd2FzIGNhbmNlbGVkICh0aGlzIHdpbGwgYWx3YXlzIGJlIGZhbHNlIGZvciBldmVudCBlbWl0dGVycylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVtaXQ8VCBleHRlbmRzIEV2ZW50T2JqZWN0Pih0YXJnZXQ6IEV2ZW50ZWQgfCBFdmVudFRhcmdldCB8IEV2ZW50RW1pdHRlciwgZXZlbnQ6IFQgfCBFdmVudE9iamVjdCk6IGJvb2xlYW47XG5leHBvcnQgZnVuY3Rpb24gZW1pdDxUIGV4dGVuZHMgRXZlbnRPYmplY3Q+KHRhcmdldDogYW55LCBldmVudDogVCB8IEV2ZW50T2JqZWN0KTogYm9vbGVhbiB7XG5cdGlmICh0YXJnZXQuZGlzcGF0Y2hFdmVudCAmJiB0YXJnZXQub3duZXJEb2N1bWVudCAmJiB0YXJnZXQub3duZXJEb2N1bWVudC5jcmVhdGVFdmVudCkge1xuXHRcdGNvbnN0IG5hdGl2ZUV2ZW50ID0gdGFyZ2V0Lm93bmVyRG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcblx0XHRuYXRpdmVFdmVudC5pbml0RXZlbnQoXG5cdFx0XHRldmVudC50eXBlLFxuXHRcdFx0Qm9vbGVhbigoPERPTUV2ZW50T2JqZWN0PiBldmVudCkuYnViYmxlcyksXG5cdFx0XHRCb29sZWFuKCg8RE9NRXZlbnRPYmplY3Q+IGV2ZW50KS5jYW5jZWxhYmxlKVxuXHRcdCk7XG5cblx0XHRmb3IgKGxldCBrZXkgaW4gZXZlbnQpIHtcblx0XHRcdGlmICghKGtleSBpbiBuYXRpdmVFdmVudCkpIHtcblx0XHRcdFx0bmF0aXZlRXZlbnRba2V5XSA9ICg8YW55PiBldmVudClba2V5XTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGFyZ2V0LmRpc3BhdGNoRXZlbnQobmF0aXZlRXZlbnQpO1xuXHR9XG5cblx0aWYgKHRhcmdldC5lbWl0KSB7XG5cdFx0aWYgKHRhcmdldC5yZW1vdmVMaXN0ZW5lcikge1xuXHRcdFx0dGFyZ2V0LmVtaXQoZXZlbnQudHlwZSwgZXZlbnQpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRlbHNlIGlmICh0YXJnZXQub24pIHtcblx0XHRcdHRhcmdldC5lbWl0KGV2ZW50KTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHR0aHJvdyBuZXcgRXJyb3IoJ1RhcmdldCBtdXN0IGJlIGFuIGV2ZW50IGVtaXR0ZXInKTtcbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhIG5vcm1hbGl6ZWQgbWVjaGFuaXNtIGZvciBsaXN0ZW5pbmcgdG8gZXZlbnRzIGZyb20gZXZlbnQgZW1pdHRlcnMsIEV2ZW50ZWQgb2JqZWN0cywgb3IgRE9NIG5vZGVzLlxuICogQHBhcmFtIHRhcmdldCBUYXJnZXQgdG8gbGlzdGVuIGZvciBldmVudCBvblxuICogQHBhcmFtIHR5cGUgRXZlbnQgZXZlbnQgdHlwZShzKSB0byBsaXN0ZW4gZm9yOyBtYXkgYSBzdHJpbmcgb3IgYW4gYXJyYXkgb2Ygc3RyaW5nc1xuICogQHBhcmFtIGxpc3RlbmVyIENhbGxiYWNrIHRvIGhhbmRsZSB0aGUgZXZlbnQgd2hlbiBpdCBmaXJlc1xuICogQHBhcmFtIGNhcHR1cmUgV2hldGhlciB0aGUgbGlzdGVuZXIgc2hvdWxkIGJlIHJlZ2lzdGVyZWQgaW4gdGhlIGNhcHR1cmUgcGhhc2UgKERPTSBldmVudHMgb25seSlcbiAqIEByZXR1cm4gQSBoYW5kbGUgd2hpY2ggd2lsbCByZW1vdmUgdGhlIGxpc3RlbmVyIHdoZW4gZGVzdHJveSBpcyBjYWxsZWRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gb24odGFyZ2V0OiBFdmVudFRhcmdldCwgdHlwZTogc3RyaW5nIHwgc3RyaW5nW10sIGxpc3RlbmVyOiBFdmVudENhbGxiYWNrLCBjYXB0dXJlPzogYm9vbGVhbik6IEhhbmRsZTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG9uKHRhcmdldDogRXZlbnRFbWl0dGVyIHwgRXZlbnRlZCwgdHlwZTogc3RyaW5nIHwgc3RyaW5nW10sIGxpc3RlbmVyOiBFdmVudENhbGxiYWNrKTogSGFuZGxlO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gb24odGFyZ2V0OiBhbnksIHR5cGU6IGFueSwgbGlzdGVuZXI6IGFueSwgY2FwdHVyZT86IGJvb2xlYW4pOiBIYW5kbGUge1xuXHRpZiAoQXJyYXkuaXNBcnJheSh0eXBlKSkge1xuXHRcdGxldCBoYW5kbGVzOiBIYW5kbGVbXSA9IHR5cGUubWFwKGZ1bmN0aW9uICh0eXBlOiBzdHJpbmcpOiBIYW5kbGUge1xuXHRcdFx0cmV0dXJuIG9uKHRhcmdldCwgdHlwZSwgbGlzdGVuZXIsIGNhcHR1cmUpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGNyZWF0ZUNvbXBvc2l0ZUhhbmRsZSguLi5oYW5kbGVzKTtcblx0fVxuXG5cdGNvbnN0IGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuXHRcdGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH07XG5cblx0Ly8gRE9NIEV2ZW50VGFyZ2V0XG5cdGlmICh0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lciAmJiB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcikge1xuXHRcdHRhcmdldC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGNhbGxiYWNrLCBjYXB0dXJlKTtcblx0XHRyZXR1cm4gY3JlYXRlSGFuZGxlKGZ1bmN0aW9uICgpIHtcblx0XHRcdHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGNhbGxiYWNrLCBjYXB0dXJlKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmICh0YXJnZXQub24pIHtcblx0XHQvLyBFdmVudEVtaXR0ZXJcblx0XHRpZiAodGFyZ2V0LnJlbW92ZUxpc3RlbmVyKSB7XG5cdFx0XHR0YXJnZXQub24odHlwZSwgY2FsbGJhY2spO1xuXHRcdFx0cmV0dXJuIGNyZWF0ZUhhbmRsZShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHRhcmdldC5yZW1vdmVMaXN0ZW5lcih0eXBlLCBjYWxsYmFjayk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0Ly8gRXZlbnRlZFxuXHRcdGVsc2UgaWYgKHRhcmdldC5lbWl0KSB7XG5cdFx0XHRyZXR1cm4gdGFyZ2V0Lm9uKHR5cGUsIGxpc3RlbmVyKTtcblx0XHR9XG5cdH1cblxuXHR0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGV2ZW50IGVtaXR0ZXIgb2JqZWN0Jyk7XG59XG5cbi8qKlxuICogUHJvdmlkZXMgYSBtZWNoYW5pc20gZm9yIGxpc3RlbmluZyB0byB0aGUgbmV4dCBvY2N1cnJlbmNlIG9mIGFuIGV2ZW50IGZyb20gZXZlbnRcbiAqIGVtaXR0ZXJzLCBFdmVudGVkIG9iamVjdHMsIG9yIERPTSBub2Rlcy5cbiAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IHRvIGxpc3RlbiBmb3IgZXZlbnQgb25cbiAqIEBwYXJhbSB0eXBlIEV2ZW50IGV2ZW50IHR5cGUocykgdG8gbGlzdGVuIGZvcjsgbWF5IGJlIGEgc3RyaW5nIG9yIGFuIGFycmF5IG9mIHN0cmluZ3NcbiAqIEBwYXJhbSBsaXN0ZW5lciBDYWxsYmFjayB0byBoYW5kbGUgdGhlIGV2ZW50IHdoZW4gaXQgZmlyZXNcbiAqIEBwYXJhbSBjYXB0dXJlIFdoZXRoZXIgdGhlIGxpc3RlbmVyIHNob3VsZCBiZSByZWdpc3RlcmVkIGluIHRoZSBjYXB0dXJlIHBoYXNlIChET00gZXZlbnRzIG9ubHkpXG4gKiBAcmV0dXJuIEEgaGFuZGxlIHdoaWNoIHdpbGwgcmVtb3ZlIHRoZSBsaXN0ZW5lciB3aGVuIGRlc3Ryb3kgaXMgY2FsbGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvbmNlKHRhcmdldDogRXZlbnRUYXJnZXQsIHR5cGU6IHN0cmluZyB8IHN0cmluZ1tdLCBsaXN0ZW5lcjogRXZlbnRDYWxsYmFjaywgY2FwdHVyZT86IGJvb2xlYW4pOiBIYW5kbGU7XG5leHBvcnQgZnVuY3Rpb24gb25jZSh0YXJnZXQ6IEV2ZW50RW1pdHRlciB8IEV2ZW50ZWQsIHR5cGU6IHN0cmluZyB8IHN0cmluZ1tdLCBsaXN0ZW5lcjogRXZlbnRDYWxsYmFjayk6IEhhbmRsZTtcbmV4cG9ydCBmdW5jdGlvbiBvbmNlKHRhcmdldDogYW55LCB0eXBlOiBhbnksIGxpc3RlbmVyOiBhbnksIGNhcHR1cmU/OiBib29sZWFuKTogSGFuZGxlIHtcblx0Y29uc3QgaGFuZGxlID0gb24odGFyZ2V0LCB0eXBlLCBmdW5jdGlvbiAoKSB7XG5cdFx0aGFuZGxlLmRlc3Ryb3koKTtcblx0XHRyZXR1cm4gbGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSwgY2FwdHVyZSk7XG5cblx0cmV0dXJuIGhhbmRsZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYXVzYWJsZUhhbmRsZSBleHRlbmRzIEhhbmRsZSB7XG5cdHBhdXNlKCk6IHZvaWQ7XG5cdHJlc3VtZSgpOiB2b2lkO1xufVxuXG4vKipcbiAqIFByb3ZpZGVzIGEgbWVjaGFuaXNtIGZvciBjcmVhdGluZyBwYXVzYWJsZSBsaXN0ZW5lcnMgZm9yIGV2ZW50cyBmcm9tIGV2ZW50IGVtaXR0ZXJzLCBFdmVudGVkIG9iamVjdHMsIG9yIERPTSBub2Rlcy5cbiAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IHRvIGxpc3RlbiBmb3IgZXZlbnQgb25cbiAqIEBwYXJhbSB0eXBlIEV2ZW50IGV2ZW50IHR5cGUocykgdG8gbGlzdGVuIGZvcjsgbWF5IGEgc3RyaW5nIG9yIGFuIGFycmF5IG9mIHN0cmluZ3NcbiAqIEBwYXJhbSBsaXN0ZW5lciBDYWxsYmFjayB0byBoYW5kbGUgdGhlIGV2ZW50IHdoZW4gaXQgZmlyZXNcbiAqIEBwYXJhbSBjYXB0dXJlIFdoZXRoZXIgdGhlIGxpc3RlbmVyIHNob3VsZCBiZSByZWdpc3RlcmVkIGluIHRoZSBjYXB0dXJlIHBoYXNlIChET00gZXZlbnRzIG9ubHkpXG4gKiBAcmV0dXJuIEEgaGFuZGxlIHdpdGggYWRkaXRpb25hbCBwYXVzZSBhbmQgcmVzdW1lIG1ldGhvZHM7IHRoZSBsaXN0ZW5lciB3aWxsIG5ldmVyIGZpcmUgd2hlbiBwYXVzZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhdXNhYmxlKHRhcmdldDogRXZlbnRUYXJnZXQsIHR5cGU6IHN0cmluZyB8IHN0cmluZ1tdLCBsaXN0ZW5lcjogRXZlbnRDYWxsYmFjaywgY2FwdHVyZT86IGJvb2xlYW4pOiBQYXVzYWJsZUhhbmRsZTtcbmV4cG9ydCBmdW5jdGlvbiBwYXVzYWJsZSh0YXJnZXQ6IEV2ZW50RW1pdHRlciB8IEV2ZW50ZWQsIHR5cGU6IHN0cmluZyB8IHN0cmluZ1tdLCBsaXN0ZW5lcjogRXZlbnRDYWxsYmFjayk6IFBhdXNhYmxlSGFuZGxlO1xuZXhwb3J0IGZ1bmN0aW9uIHBhdXNhYmxlKHRhcmdldDogYW55LCB0eXBlOiBhbnksIGxpc3RlbmVyOiBhbnksIGNhcHR1cmU/OiBib29sZWFuKTogUGF1c2FibGVIYW5kbGUge1xuXHRsZXQgcGF1c2VkOiBib29sZWFuO1xuXG5cdGNvbnN0IGhhbmRsZSA9IDxQYXVzYWJsZUhhbmRsZT4gb24odGFyZ2V0LCB0eXBlLCBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKCFwYXVzZWQpIHtcblx0XHRcdHJldHVybiBsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH1cblx0fSwgY2FwdHVyZSk7XG5cblx0aGFuZGxlLnBhdXNlID0gZnVuY3Rpb24gKCkge1xuXHRcdHBhdXNlZCA9IHRydWU7XG5cdH07XG5cblx0aGFuZGxlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRwYXVzZWQgPSBmYWxzZTtcblx0fTtcblxuXHRyZXR1cm4gaGFuZGxlO1xufVxuIl19